# Tactical Patterns Library - 戦術パターンライブラリ

戦闘でより戦略的で多様な行動を実現するための戦術パターン定義集です。

## ⚔️ 基本戦術カテゴリ

### 1. 攻撃パターン (Attack Patterns)

#### 突撃系 (Charge Patterns)
```
"charge_direct": 直線突撃
- 条件: 敵まで3タイル以内、間に障害物なし
- 効果: 移動+攻撃, 攻撃力+20%, 被ダメージ+10%
- 評価: 距離が近いほど高評価 (distance <= 2: +3.0)

"charge_flank": 側面突撃
- 条件: 敵の側面または背面に回り込み可能
- 効果: 移動+攻撃, 攻撃力+30%, 反撃回避50%
- 評価: 側面攻撃 +2.5, 背面攻撃 +4.0

"berserker_rush": 狂戦士突撃
- 条件: HP50%以下、敵まで2タイル以内
- 効果: 移動+攻撃, 攻撃力+50%, 防御力-30%
- 評価: HP低いほど高評価 +(50-現HP%)*0.1
```

#### 連携攻撃系 (Coordinated Patterns)
```
"pincer_attack": 挟撃
- 条件: 味方が敵を挟める位置にいる
- 効果: 攻撃力+25%, 敵の逃走制限
- 評価: 参加味方数 * 1.5, 敵包囲度 * 2.0

"focus_fire": 集中砲火
- 条件: 複数味方が同じ敵を狙える
- 効果: 全員の攻撃力+15%, 確実撃破狙い
- 評価: 敵HP低いほど高評価 +(100-敵HP%)*0.05

"formation_strike": 陣形攻撃
- 条件: 味方3体以上が陣形維持
- 効果: 攻撃力+10%, 反撃ダメージ-20%
- 評価: 陣形維持度 * 2.0, 味方数 * 0.8
```

### 2. 防御パターン (Defense Patterns)

#### 位置取り系 (Positioning Patterns)
```
"defensive_formation": 防御陣形
- 条件: 味方2体以上
- 効果: 被ダメージ-15%, 味方支援+1行動
- 評価: 味方HP総量考慮, 危険度-1.5

"cover_seeking": 遮蔽利用
- 条件: 壁や障害物が隣接
- 効果: 遠距離攻撃ダメージ-50%
- 評価: 敵遠距離攻撃者数 * 2.0

"chokepoint_hold": 狭路防衛
- 条件: 幅1-2タイルの通路
- 効果: 通路封鎖, 敵移動制限
- 評価: 通路狭さ * 2.5, 背後安全度 * 1.5
```

#### 後退系 (Retreat Patterns)
```
"tactical_retreat": 戦術的後退
- 条件: HP30%以下または数的劣勢
- 効果: 移動距離+1, 反撃回避
- 評価: 危険度 * 2.0, HP残量反比例

"fighting_withdrawal": 戦闘的撤退
- 条件: 後退しながら攻撃可能
- 効果: 移動+攻撃, 攻撃力-20%
- 評価: 後方安全度 * 1.8, 敵追跡可能性-1.0

"sacrifice_cover": 身代わり撤退
- 条件: 味方の退路確保のため
- 効果: 味方の移動+2, 自身危険度+50%
- 評価: 救援対象価値 * 3.0, 英雄的個性 +2.0
```

### 3. 機動パターン (Mobility Patterns)

#### 移動系 (Movement Patterns)
```
"flanking_maneuver": 側面機動
- 条件: 敵側面に移動ルートあり
- 効果: 次ターン攻撃+30%
- 評価: 回り込み完了度 * 2.2

"hit_and_run": ヒット&ラン
- 条件: 攻撃後に後退可能
- 効果: 攻撃+移動, 反撃回避80%
- 評価: 機動力 * 1.8, 狡猾個性 +1.5

"positioning_advance": 陣地移動
- 条件: より有利な位置への移動
- 効果: 次ターン全行動+15%効果
- 評価: 位置優位度 * 2.0

"evasive_maneuver": 回避機動
- 条件: 複数敵に囲まれている
- 効果: 全攻撃回避+25%
- 評価: 包囲敵数 * 1.5, HP残量反比例
```

### 4. 支援パターン (Support Patterns)

#### 味方援護系 (Allied Support)
```
"bodyguard_position": 護衛配置
- 条件: 重要味方の隣接位置
- 効果: 味方への攻撃を代理受け
- 評価: 守る味方重要度 * 2.5

"healing_priority": 治療優先
- 条件: 味方HP30%以下
- 効果: 治療効果+50%
- 評価: 味方HP危険度 * 3.0

"tactical_coordination": 戦術連携
- 条件: 味方の行動と連携可能
- 効果: 連携効果+25%
- 評価: 連携参加者数 * 1.2, 効果予測値 * 2.0
```

## 🧠 パターン選択アルゴリズム

### 基本選択プロセス
```
1. 現在状況の評価
   - 戦力比較 (味方 vs 敵)
   - 位置関係分析
   - HP/リソース状況

2. 利用可能パターンの抽出
   - 条件チェック
   - リソース要件確認
   - 個性適性判定

3. パターン評価値計算
   基本評価値 = 状況適合度 × パターン効果値
   個性修正 = 個性タイプ適性 × 個性強度
   最終評価 = 基本評価値 + 個性修正

4. 最適パターン選択
   - 評価値上位3パターンから選択
   - ランダム要素5%を付加
   - 前ターンとの重複回避
```

### 状況別優先パターン

#### 数的優位時 (味方多数)
```
優先度順:
1. "focus_fire" - 確実な敵削減
2. "pincer_attack" - 包囲による制圧
3. "formation_strike" - 陣形での圧迫
4. "flanking_maneuver" - 側面攻撃準備
```

#### 数的劣勢時 (敵多数)
```
優先度順:
1. "chokepoint_hold" - 地形利用防御
2. "tactical_retreat" - 戦術的後退
3. "hit_and_run" - ゲリラ戦法
4. "evasive_maneuver" - 包囲突破
```

#### HP危険時 (30%以下)
```
優先度順:
1. "tactical_retreat" - 安全確保
2. "cover_seeking" - 遮蔽利用
3. "fighting_withdrawal" - 戦闘撤退
4. "berserker_rush" - 最後の攻撃
```

#### 均衡状態時
```
優先度順:
1. "positioning_advance" - 有利ポジション確保
2. "tactical_coordination" - 味方連携
3. "flanking_maneuver" - 側面攻撃準備
4. "defensive_formation" - 安定陣形
```

## 📈 パターン学習システム

### 成功・失敗の記録
```
パターン成功時:
- 該当パターンの評価値 +0.2
- 類似状況での選択確率上昇
- 個性適性度微調整

パターン失敗時:
- 該当パターンの評価値 -0.1
- 代替パターンの検討
- 失敗要因の分析記録
```

### 適応型パターン生成
```
既存パターンの組み合わせ:
- 成功パターン2つの融合
- 状況特化型の派生作成
- 個性特化パターンの自動生成

学習限界:
- パターン数上限: 50個
- 評価値変動幅: ±2.0
- 学習期間: 100ターン周期でリセット
```

---

この戦術パターンライブラリにより、NPCは状況に応じた多様で戦略的な行動を取り、プレイヤーに常に新しい挑戦を提供できます。